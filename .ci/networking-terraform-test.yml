networking-prep-test-cases-pull:
  stage: tf-prep-test-case-pull
  rules:
    - if: '$CI_PIPELINE_SOURCE == "push"'
      changes:
        - "*.tf"
        - "*.yml"
  script:
    - set -o pipefail
    - echo "  ----- BEGIN - Running Test Cases on Pull Request -----  "
    - echo "  ----- Running terraform fmt before run -----  "
    - terraform fmt -recursive
    - git add .
    - git commit -m "Automated commit from pipeline [skip ci]" || echo "No changes to commit"
    - git remote set-url origin https://terraform-runner-token:${CI_ACCESS_TOKEN}@orahub.oci.oraclecorp.com/nace-shared-services/oci-core-landing-zone.git
    - git push origin HEAD:$CI_COMMIT_BRANCH
    - echo "  ----- Completed terraform fmt before run -----  "